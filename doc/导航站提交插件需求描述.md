# Chrome 插件需求文档：导航站自动提交工具

## 一、产品背景与目标

作为独立开发者，你需要每天将自己的网站提交到各类导航站，获取曝光和外链。这件事高度重复、耗时且容易出错。  
本项目目标是开发一个 **Chrome 浏览器插件**，在用户打开各类导航站的“提交网站”页面时，自动识别表单并一键填写/提交，大幅提升导航站收录提交效率，减少重复劳动。

简而言之：插件负责“自动填表 + 半自动提交”，你负责“选择导航站 + 基本确认”。

---

## 二、目标用户与使用场景

- **目标用户**
  - 独立开发者、个人站长
  - 需要频繁提交多个站点到大量导航站的人
- **典型使用场景**
  1. 用户从自己的“导航站列表”中打开一个导航站提交页面（或手动打开）。
  2. 插件自动识别当前页面是否为“提交网站/提交收录”表单。
  3. 插件自动填充站点信息（名称、URL、描述等），用户点击确认按钮提交。
  4. 提交后记录该导航站的提交状态，方便后续查看。

---

## 三、核心功能需求

### 3.0 导航站常用提交字段（参考标准）

各导航站所需信息不一，以下为**最常见**的提交字段清单。插件“站点档案”与“字段映射”设计应覆盖这些字段，以便与多数导航站表单对接。

| 字段 | 英文常见命名 | 说明 | 是否必填（视导航站而定） |
|------|----------------|------|---------------------------|
| 网站名称 | Site Name | 站点展示名称 | 常见必填 |
| 联系邮箱 | Email | 用于收录联系、通知 | 常见必填 |
| 网站 URL | Site URL / Website URL | 站点首页或主链接 | 常见必填 |
| 分类 | Category | 所属分类（多为下拉/单选） | 常见必填 |
| 标语/口号 | Tagline | 一句话 Slogan | 部分站点需要 |
| 简短描述 | Short Description | 一两句话简介 | 常见必填 |
| 详细描述 | Long Description | 多段落的详细介绍 | 部分站点需要 |
| Logo | Logo / Icon | 网站图标（多为 URL 或上传） | 部分站点需要 |
| 界面截图 | Screenshot | 网站首页或功能截图 | 部分站点需要 |

**说明**：插件内“站点档案”需至少支持上述字段的配置与存储；表单识别与映射规则按域名适配时，将上述字段与页面实际表单项（name/id/label/placeholder）对应即可。

---

### 3.1 网站信息管理

1. **站点配置管理**
   - 用户可以在插件中维护多个“自己的网站档案”，字段需覆盖 **3.0 导航站常用提交字段**，例如：
     - 站点名称（Site Name，多语言可选）
     - 联系邮箱（Email）
     - 站点 URL（Site URL）
     - 分类/标签（Category，如：AI 工具、音乐、图片、视频等）
     - 标语/口号（Tagline）
     - 简短描述（Short Description，支持多版本：中文简短版 / 英文版等）
     - 详细描述（Long Description）
     - 站点 Logo 图片 URL（Logo）
     - 界面截图 URL 或本地资源（Screenshot，可选）
   - 支持新增 / 编辑 / 删除站点档案。
   - 支持选择“默认站点”，在无特别指定时使用。

2. **快速切换当前使用站点**
   - 插件弹窗中可以切换当前要提交的站点（下拉选择）。

3. **网站信息存储方案（选定）**
   - **采用方案：插件存储区（Chrome Storage）**
   - 站点档案、导航站列表、字段映射规则、提交记录等，统一存储在 `chrome.storage.local`（或部分用 `chrome.storage.sync` 做跨设备同步），不依赖“指定本地文件路径”读写。
   - **理由简述**：
     - **实现与维护**：无需申请本地文件系统权限，也无须开发 Native Messaging 或本地守护进程，实现简单、跨平台一致，Chrome 审核友好。
     - **安全与隐私**：数据仅存于浏览器侧，不涉及任意路径读写，用户心智清晰。
     - **容量**：`storage.local` 足够存放多站点档案与大量导航站列表；若未来需更大数据，可再考虑 IndexedDB，仍不依赖本地文件路径。
   - **与“后台配置”的衔接**：
     - 配置入口：在插件 **Options 页（设置/管理页面）** 提供完整的站点档案与导航站列表的增删改，即“在插件后台进行配置”。
     - 若需与外部系统或本地文件互通，提供 **导入/导出** 即可：支持从 **JSON 文件导入**（用户通过“选择文件”选择）、以及 **导出为 JSON 下载**，便于与网站后台或脚本联动，无需读写用户指定路径。
   - **不采用**“指定本地文件路径”作为主存储的原因：Chrome 扩展无法直接读写用户任意路径；若通过 Native Messaging 实现，需额外安装本地应用，开发和用户使用成本高，维护负担大，故不作为默认方案。若后续有强需求，可单独作为可选进阶功能（如：仅导出到用户选择的路径）。

4. **备份与恢复（重装后快速恢复配置）**
   - **使用场景**：插件重装或换机后，本地存储被清空，用户无需重新手动添加站点、导航站列表和映射规则，通过“从备份恢复”即可还原全部配置。
   - **备份（导出完整配置）**
     - 在 Options 页提供 **“备份配置”/“导出备份”** 按钮。
     - 导出一份 **完整备份 JSON 文件**，包含当前所有：
       - 站点档案（多个站点及全部字段）
       - 导航站列表
       - 按域名的识别结果缓存（字段映射缓存）
       - 提交记录（可选，也可仅备份配置而排除记录）
     - 文件通过浏览器“下载”交给用户，由用户自行保存到本地或网盘；建议文件名带时间戳，便于区分多份备份（如 `nav-submitter-backup-20250207.json`）。
   - **恢复（从备份导入）**
     - 在 Options 页提供 **“从备份恢复”/“导入备份”**，用户选择此前导出的备份 JSON 文件。
     - 解析后支持两种策略（可做成选项）：
       - **覆盖**：用备份数据完全替换当前存储（适合重装后恢复）。
       - **合并**：将备份中的站点、导航站、规则等与现有数据合并，冲突时由用户选择保留哪一侧或采用备份数据。
     - 恢复完成后给予明确提示（如“已恢复 X 个站点、Y 个导航站”），便于用户确认。
   - **与“导入/导出”的关系**：备份文件即“完整版导出”；若后续支持仅导出“导航站列表”或仅“站点档案”，可复用同一 JSON 结构，在恢复时按数据类型选择性写入。备份与恢复为**必须实现**功能，以解决重装后重复配置的问题。

---

### 3.2 导航站表单自动识别与填充

**设计原则**：用语义识别自动得到“页面表单项 → 标准字段”的映射，避免维护按域名的可配置规则；**LLM 仅参与必要环节**，不贯穿全流程，以控制处理时长与成本。

---

1. **表单结构采集（无 LLM，本地完成）**
   - 插件在用户访问页面时，自动扫描 DOM，收集表单内所有可填项的结构化信息，例如：
     - 每个控件的：`name`、`id`、`type`、`placeholder`、关联的 `label` 文字、`aria-label`、父级/相邻文案等，以及用于 DOM 定位的稳定标识（如 `id`、`name`、或在表单中的索引）。
     - 下拉框/单选：选项列表（仅文本，用于后续匹配分类）。
   - 输出为一份**表单元数据**（不包含用户真实站点数据），供后续“语义识别”或“规则匹配”使用；后续填充阶段仅根据映射结果做 **DOM 辅助定位** 并填值，不再调用 LLM。

2. **LLM 仅在必要环节：表单字段语义识别 → DOM 辅助定位（必要）**
   - **原则**：LLM 不参与“表单采集、填充动作、提交”等步骤，仅在**需要得到“页面字段 → 标准字段”映射**时调用一次，用于精确实现 **DOM 辅助定位**（即确定每个表单项对应 3.0 中哪一标准字段，以便正确填值）。
   - **流程（仅此环节可能调用 LLM）**：
     1. 从页面提取表单元数据（见上），整理成简短、结构化的文本，并为每个表单项附带**可定位标识**（如 `id`、`name` 或序号），便于解析结果后反查 DOM。
     2. **仅在此处**调用 LLM：请求内容 = 标准字段列表（3.0：Site Name、Email、Site URL、Category、Tagline、Short Description、Long Description、Logo、Screenshot 等）+ 当前页表单元数据；**不发送用户站点真实数据**。
     3. 通过**固定、精简的提示词**要求 LLM 返回**结构化结果**（如 JSON），例如：`[{ "fieldId": "site_name", "standardField": "Site Name" }, ...]`，便于程序精确解析并用于 DOM 定位与填充。
     4. 插件解析返回的映射后，按“可定位标识”找到对应 DOM 元素，从站点档案取标准字段值填入；**此后不再调用 LLM**。
   - **提示词要求**（需在实现时落实）：
     - 明确说明任务：根据表单项的 label/name/placeholder 等，将每个表单项映射到给定的标准字段之一；无法对应的填 `unknown` 或省略。
     - 严格要求输出格式（如 JSON 数组），并约定字段标识与标准字段枚举值，以便稳定解析、实现 DOM 辅助定位。
     - 控制输入长度（表单元数据做摘要或截断），减少 token 与延迟。
   - **按域名缓存**：同一域名首次识别成功后，将“表单元数据指纹 + 映射结果”缓存在本地，下次同页**直接使用缓存**，不再请求 LLM；页面结构大变时用户可触发“重新识别”。

3. **LLM 接入方式（OpenAI 兼容接口，含 GLM）**
   - 插件通过 **OpenAI 兼容的 API** 调用 LLM（请求/响应格式与 OpenAI Chat Completions 一致），便于接入多种后端：
     - 用户可在 Options 页配置 **API 端点（Base URL）** 与 **API Key**；若使用自建或第三方 GLM 服务，只需提供兼容 OpenAI 的接口地址与 Key 即可，无需单独开发适配。
     - 不内置任何默认 endpoint 或 Key；用户自行填写并本地保存，插件不上传 Key。
   - 后续若有需求，可扩展支持本地模型（如通过 Native Messaging 或本地 HTTP 服务），数据不出本机。

4. **Fallback：关键词/启发式匹配（无 LLM 或 LLM 不可用时）**
   - 当用户未配置 LLM，或 LLM 调用失败、超时时，使用**简单规则**对表单元数据做匹配（同上），得到“页面字段 → 标准字段”映射，仍可实现 DOM 辅助定位与填充，仅准确率可能略低。

5. **可选：单次手动修正与缓存**
   - 当自动识别（LLM 或启发式）结果有误时，提供轻量级手动修正（如列表中选择每个表单项对应的标准字段并保存为当前域名缓存），不要求“点击页面元素绑定”的完整规则配置。

6. **自动填充（无 LLM 参与）**
   - 在得到映射后：根据映射中的可定位标识找到 DOM 元素，从站点档案取对应标准字段值填入；分类为下拉/单选时优先用**本地**字符串匹配选项，不在此步骤调用 LLM。
   - 提供显眼按钮：**“一键填充当前页面”**；若未识别到表单或映射为空，提示“未识别到可填充的表单，可检查页面或尝试重新识别”。

7. **可选功能：网站介绍语编写（LLM 可选参与）**
   - **定位**：与“表单识别/填充”流程解耦，**不参与**默认的填表流程；仅在用户主动使用或设置中开启时生效。
   - **能力**：根据站点名称、URL、已有简介等，调用 LLM 生成或润色**简短描述（Short Description）**、**详细描述（Long Description）**、**标语（Tagline）** 等，供用户采纳后写入站点档案或临时用于某次提交。
   - **交互**：如在站点管理/编辑中提供“生成介绍语”按钮，或在一键填充前提供“先生成描述再填充”的选项；调用次数由用户触发决定，不影响常规填表耗时。
   - 实现时可复用同一 OpenAI 兼容接口与 Key；提示词需针对“导航站网站介绍”场景设计，输出简洁、可直接用于提交的文案。

---

### 3.3 提交流程辅助

1. **半自动提交**
   - 填充完成后，由用户手动点击页面上的“提交”按钮（默认方式，安全、兼容性高）。
   - 插件可提供一个提示：比如弹出提示“表单已填充，请检查后点击提交”。

2. **可选：自动点击提交按钮（按站点可配置）**
   - 在某些确认稳定、格式简单的导航站，支持开启“自动提交模式”：
     - 自动找到“提交/保存”按钮并触发点击事件。
   - 每个域名配置是否允许自动提交，默认关闭。

3. **验证码处理**
   - 插件不直接突破验证码，只提供辅助逻辑：
     - 自动填充完成后，若检测到页面存在验证码输入框或图形验证码元素，提示用户手动完成。
     - 给出提示：“已自动填表，请完成验证码后手动提交。”

---

### 3.4 导航站列表与提交记录

1. **导航站列表管理**
   - 用户可以在插件中维护一个“导航站收录页面列表”：
     - 导航站名称
     - 提交页面 URL
     - 所属分类（如：中文导航 / 国外导航 / 行业导航）
   - 支持：
     - 新增 / 编辑 / 删除导航站
     - 导入 / 导出列表（如 JSON 文本）

2. **提交状态记录**
   - 对于每个导航站 + 每个站点，记录以下信息：
     - 最近一次提交时间
     - 当前状态（未提交 / 已提交 / 提交中 / 失败-待重试）
     - 备注（可手动填写，如：已收录、被拒绝等）
   - 仅依赖本地存储（Chrome storage），不强制与导航站实际收录结果联动。

3. **简易统计**
   - 显示当前选定站点的导航站提交进度：
     - 已提交数量
     - 未提交数量
     - 最近 N 天提交记录（简单列表即可）

---

### 3.5 插件 UI 设计（功能层面）

1. **浏览器工具栏弹窗（popup）**
   - 主要内容：
     - 当前选中站点（可切换）
     - 快捷按钮：
       - “自动填充当前页面”
       - “打开导航站列表”
       - “管理站点信息”
     - 当前页面识别结果：
       - 显示识别出的表单字段数量
       - 若未识别出表单，提示“未识别到提交表单，可尝试规则配置”

2. **设置/管理页面（options page）**
   - Tab 结构建议：
     - “站点管理”
     - “导航站列表”
     - “识别与填充”（配置 LLM API 可选、查看/清除按域名的识别缓存、可选的手动映射）
     - “备份与恢复”（导出完整备份 / 从备份文件恢复，解决重装后重新配置问题）
     - “高级设置”
   - 每个模块提供表格式列表 + 编辑弹窗即可。
   - “备份与恢复”页需提供显眼操作：**备份配置**（下载 JSON）、**从备份恢复**（选择文件并导入）。

---

## 四、非功能需求

1. **运行环境**
   - Chrome 浏览器扩展，基于 Manifest V3。
   - 兼容 Chromium 内核浏览器（如 Edge、Brave 等）优先考虑，但非首要目标。

2. **数据存储**
   - 以 **插件存储区** 为唯一主存储，使用 `chrome.storage.local`（主）与可选 `chrome.storage.sync`（若需跨设备同步）存储：
     - 站点档案（含 3.0 所列常用提交字段）
     - 导航站列表
     - 按域名的识别结果缓存（LLM 或启发式/手动得到的“页面字段→标准字段”映射）
     - 提交记录
   - 数据仅保存在用户浏览器本地，不上传到第三方服务器（保证隐私和审核友好）。
   - 提供 **完整备份导出** 与 **从备份恢复**（见 3.1.4），以及通用 **JSON 导入/导出**，便于重装后恢复、与网站后台或本地脚本联动，不依赖“指定本地文件路径”读写。

3. **权限控制**
   - 仅申请必要权限：
     - `activeTab` / `scripting`：插入内容脚本进行表单识别和填充
     - `storage`：保存配置和记录
     - 必要的 host 权限（考虑使用 `activeTab` 或用户手动添加匹配域名）

4. **性能要求**
   - 内容脚本应轻量级，避免对页面加载速度产生明显影响。
   - 表单识别应在页面加载完成后的短时间内完成（如 1–2 秒内）。

5. **安全要求**
   - 不收集用户敏感数据（密码、账号等）。
   - 不对非“提交网站”场景的表单做任何自动填充操作（通过字段关键词过滤）。

6. **LLM 使用约定（可选能力）**
   - **接入**：采用 **OpenAI 兼容接口**（请求/响应格式与 OpenAI Chat Completions 一致），用户配置 **API 端点（Base URL）** 与 **API Key** 即可；支持自建或第三方 **GLM** 等兼容服务，无需单独适配。
   - **必要环节**：LLM 仅用于 **表单字段语义识别 → DOM 辅助定位**（根据表单元数据返回“页面字段→标准字段”的映射），且结果按域名缓存，同一页面不重复调用；**不参与**表单采集、填充动作、提交等步骤，避免处理时长过长。
   - **提示词与输出**：该环节使用固定、精简的 prompt，并约定 LLM 返回**结构化结果**（如 JSON），便于精确解析并实现 DOM 定位；请求中仅包含表单结构信息，不包含用户站点真实数据。
   - **可选功能**：如“网站介绍语编写”等由用户主动触发的 LLM 能力，与填表流程解耦，不参与默认流程。
   - **权限与隐私**：启用 LLM 时需发起对用户所配 API 的请求，需在 manifest 或可选权限中说明网络访问；API Key、端点仅在本地保存，插件不内置或上传。用户不配置 LLM 时，仅用启发式与手动缓存，无网络请求。

---

## 五、后续扩展方向（可选）

这些不是首发版本必须实现的，但可以作为未来迭代方向：

1. **LLM 辅助网站介绍语编写**
   - 用户主动触发时，根据站点名称、URL、已有简介等，用 LLM 生成或润色 Short Description、Long Description、Tagline，供采纳后写入站点档案或单次提交使用；与填表流程解耦，不增加默认流程耗时（见 3.2.7）。

2. **多站点随机描述轮换**
   - 支持为同一站点准备多个描述版本，在不同导航站间轮流使用，减少重复内容。

3. **多语言支持**
   - 根据导航站语言，自动选择对应语言版本的站点名称和描述（简单基于域名 / 语言检测）。

4. **导入现有导航站集合**
   - 支持从外部 JSON/CSV 导入大量导航站收录链接。

5. **与 SEO 工具联动**
   - 导出提交记录为 CSV，方便与 SEO 监控工具结合分析。

---

## 六、版本规划（MVP 建议）

**MVP 版本必须实现：**

1. 站点信息管理（单站点也可以，先实现基础）。
2. 表单结构采集 + **LLM 辅助语义识别**（页面字段→标准字段映射），未配置 LLM 时使用关键词/启发式匹配兜底。
3. 按域名缓存识别结果，减少重复调用；一键填充当前页面。
4. 导航站列表管理（简单列表 + 手动打开链接）。
5. 提交记录：至少记录“已提交时间”。
6. **备份与恢复**：支持导出完整配置为 JSON 备份、从备份文件导入恢复（覆盖或合并），解决插件重装后需重新配置的问题。

**可以延后实现的：**

1. 自动点击提交按钮。
2. 复杂分类字段匹配逻辑（如 LLM 辅助选择下拉项）。
3. 恢复时的“合并”策略（MVP 可先只做“覆盖”）。
4. 完整的“点击页面元素绑定映射”的可视化规则配置；MVP 可用轻量级“下拉选择映射并保存为域名缓存”代替。
5. 多语言站点描述管理。

---

以上需求文档偏向开发视角，已经把数据结构、功能模块和权限等关键点铺开，可以直接据此拆分为开发任务（Manifest、content script、background、options 页面、popup 页面等），并逐步实现 MVP → 迭代增强。